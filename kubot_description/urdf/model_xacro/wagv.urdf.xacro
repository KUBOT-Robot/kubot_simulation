<?xml version="1.0"?>

<robot name="kubot" xmlns:xacro="https://ros.org/wiki/xacro">

  <xacro:include filename="$(find kubot_description)/urdf/kubot_properties.urdf.xacro"/>

  <xacro:macro name="base">
    <!-- Robot Frame  a.k.a base_link -->
    <link name="base_link">

        <visual name="visual_base">
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/base_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
            <xacro:material_light_blue/>
        </visual>

        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/base_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
            <xacro:material_white/>
        </collision>

        <inertial>
          <origin xyz="0 0 0" rpy="0 0 0" />
          <mass value="123.9982" />
          <inertia
              ixx="0.09617045"
              ixy="3.5340082E-05"
              ixz="2.5462637E-04"
              iyy="0.1155512"
              iyz="-4.2933341E-05"
              izz="1.0718441E-01" />
      </inertial>
    </link>

    <!-- r1_frame-->
    <link name= "r1_frame">

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/r1_frame.stl" scale="0.001 0.001 0.001"/>
            </geometry>
            <xacro:material_white/>
        </visual>
    </link>

    <!-- r2_frame-->
    <link name= "r2_frame">

        <visual>
            <origin xyz="0 0 0.05" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/r2_frame.stl" scale="0.001 0.001 0.001"/>
            </geometry>
            <xacro:material_dark_blue/>
        </visual>
    </link>

    <!-- Right Wheel_frame-->
    <link name= "wheel_right_link">

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/wheel_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
            <xacro:material_black/>
        </visual>

        <collision>
              <origin xyz="0 0 0" rpy="0 0 0"/>
              <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/wheel_link.stl" scale="0.001 0.001 0.001"/>
              </geometry>
              <xacro:material_white/>
         </collision>

    </link>

    <!-- Left Wheel_frame-->
    <link name= "wheel_left_link">

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/wheel_link.stl" scale="0.001 0.001 0.001"/>
            </geometry>
            <xacro:material_black/>
        </visual>

            <collision>
              <origin xyz="0 0 0" rpy="0 0 0"/>
              <geometry>
                <mesh filename="package://kubot_description/meshes/robot_frame/wagv/wheel_link.stl" scale="0.001 0.001 0.001"/>
              </geometry>
              <xacro:material_white/>
         </collision>

    </link>  

   <joint name="r1_joint" type="fixed">
      <parent link="base_link"/>
      <child link="r1_frame"/>
   </joint>

   <joint name="r2_joint" type="fixed">
      <parent link="base_link"/>
      <child link="r2_frame"/>
   </joint>   

  <joint name="r_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_right_link"/>
    <origin xyz="0.0 -0.275 0.07" rpy="0 0 0"/>
    <axis xyz="0 -1 0"/>
  </joint>

  <joint name="l_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_left_link"/>
    <origin xyz="0.0 0.275 0.07" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
  </joint> 

  </xacro:macro>

  <!-- Lidar Frame a.k.a Lidar Pos-->
  <xacro:property name="lidar_joint_xyz" value="0.255 0 0.24"/>
  <xacro:property name="lidar_joint_rpy" value="0 0 0"/>
  
  <!-- Camera a.k.a Camera Pos -->
  <xacro:property name="camera_pos_rear" value="false"/>

  <xacro:if value="${camera_pos_rear}">
    <xacro:property name="camera_joint_xyz" value="0.26 0 0.17"/>
  </xacro:if>
  <xacro:unless value="${camera_pos_rear}">
    <xacro:property name="camera_joint_xyz" value="0 0 0"/>
  </xacro:unless>
  
  <xacro:property name="camera_joint_rpy" value="0 0 0"/>
</robot>
